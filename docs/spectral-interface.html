<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon" href="/assets/images/favicon-32.png" type="image/x-icon" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Spectral Inference | Machine Learning Ops</title>
<meta name="generator" content="Jekyll v4.1.0" />
<meta property="og:title" content="Spectral Inference" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Spectral Inference Networks (SpIN) Prerequisites Installation Usage Create variables for simple MLP Create function to construct simple MLP Squared exponential kernel. Constructs the internal training ops for spectral inference networks. Trivial defaults for logging and stats hooks. Executes the training of spectral inference networks. Spectral Inference Networks (SpIN) This package provides an implementation of Spectral Inference Networks, as in Pfau, Petersen, Agarwal, Barrett and Stachenfeld (2018). This is not an officially supported Google product. Prerequisites SpIN requires a working installation of Python and TensorFlow. We recommend running it on GPU for faster convergence. If you want to make use of the GUI (on by default) you will also need Tcl/Tk installed on your system. Installation After cloning the repo, run pip to install the package and its Python dependencies: cd spectral_inference_networks pip install . Usage Training a spectral inference network is similar to most other deep learning pipelines: you must construct a data source, network architecture and optimizer. What makes spectral inference networks unique is that instead of a loss you provide a linear operator to diagonalize. The code expects an object of the LinearOperator class, which can be constructed from a similarity kernel or by other means. LinearOperator objects can be added together or multiplied by a scalar. Below is a minimal example of training spectral inference networks: ```python import tensorflow as tf import spectral_inference_networks as spin batch_size = 1024 input_dim = 10 num_eigenvalues = 5 iterations = 1000 # number of training iterations Create variables for simple MLP w1 = tf.Variable(tf.random.normal([input_dim, 64])) w2 = tf.Variable(tf.random.normal([64, num_eigenvalues])) b1 = tf.Variable(tf.random.normal([64])) b2 = tf.Variable(tf.random.normal([num_eigenvalues])) Create function to construct simple MLP def network(x): h1 = tf.nn.relu(tf.matmul(x, w1) + b1) return tf.matmul(h1, w2) + b2 data = tf.random.normal([batch_size, input_dim]) # replace with actual data Squared exponential kernel. kernel = lambda x, y: tf.exp(-(tf.norm(x-y, axis=1, keepdims=True)**2)) linop = spin.KernelOperator(kernel) optim = tf.train.AdamOptimizer() Constructs the internal training ops for spectral inference networks. spectral_net = spin.SpectralNetwork( linop, network, data, [w1, w2, b1, b2]) Trivial defaults for logging and stats hooks. logging_config = { ‘config’: {}, ‘log_image_every’: iterations, ‘save_params_every’: iterations, ‘saver_path’: ‘/tmp’, ‘saver_name’: ‘example’, } stats_hooks = { ‘create’: spin.util.create_default_stats, ‘update’: spin.util.update_default_stats, } Executes the training of spectral inference networks. stats = spectral_net.train( optim, iterations, logging_config, stats_hooks)" />
<meta property="og:description" content="Spectral Inference Networks (SpIN) Prerequisites Installation Usage Create variables for simple MLP Create function to construct simple MLP Squared exponential kernel. Constructs the internal training ops for spectral inference networks. Trivial defaults for logging and stats hooks. Executes the training of spectral inference networks. Spectral Inference Networks (SpIN) This package provides an implementation of Spectral Inference Networks, as in Pfau, Petersen, Agarwal, Barrett and Stachenfeld (2018). This is not an officially supported Google product. Prerequisites SpIN requires a working installation of Python and TensorFlow. We recommend running it on GPU for faster convergence. If you want to make use of the GUI (on by default) you will also need Tcl/Tk installed on your system. Installation After cloning the repo, run pip to install the package and its Python dependencies: cd spectral_inference_networks pip install . Usage Training a spectral inference network is similar to most other deep learning pipelines: you must construct a data source, network architecture and optimizer. What makes spectral inference networks unique is that instead of a loss you provide a linear operator to diagonalize. The code expects an object of the LinearOperator class, which can be constructed from a similarity kernel or by other means. LinearOperator objects can be added together or multiplied by a scalar. Below is a minimal example of training spectral inference networks: ```python import tensorflow as tf import spectral_inference_networks as spin batch_size = 1024 input_dim = 10 num_eigenvalues = 5 iterations = 1000 # number of training iterations Create variables for simple MLP w1 = tf.Variable(tf.random.normal([input_dim, 64])) w2 = tf.Variable(tf.random.normal([64, num_eigenvalues])) b1 = tf.Variable(tf.random.normal([64])) b2 = tf.Variable(tf.random.normal([num_eigenvalues])) Create function to construct simple MLP def network(x): h1 = tf.nn.relu(tf.matmul(x, w1) + b1) return tf.matmul(h1, w2) + b2 data = tf.random.normal([batch_size, input_dim]) # replace with actual data Squared exponential kernel. kernel = lambda x, y: tf.exp(-(tf.norm(x-y, axis=1, keepdims=True)**2)) linop = spin.KernelOperator(kernel) optim = tf.train.AdamOptimizer() Constructs the internal training ops for spectral inference networks. spectral_net = spin.SpectralNetwork( linop, network, data, [w1, w2, b1, b2]) Trivial defaults for logging and stats hooks. logging_config = { ‘config’: {}, ‘log_image_every’: iterations, ‘save_params_every’: iterations, ‘saver_path’: ‘/tmp’, ‘saver_name’: ‘example’, } stats_hooks = { ‘create’: spin.util.create_default_stats, ‘update’: spin.util.update_default_stats, } Executes the training of spectral inference networks. stats = spectral_net.train( optim, iterations, logging_config, stats_hooks)" />
<link rel="canonical" href="https://mlops-github.com/docs/spectral-interface.html" />
<meta property="og:url" content="https://mlops-github.com/docs/spectral-interface.html" />
<meta property="og:site_name" content="Machine Learning Ops" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-06-16T12:38:47-05:00" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"https://mlops-github.com/docs/spectral-interface.html"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://mlops-github.com/assets/images/Data-driven-recommendations.png"}},"description":"Spectral Inference Networks (SpIN) Prerequisites Installation Usage Create variables for simple MLP Create function to construct simple MLP Squared exponential kernel. Constructs the internal training ops for spectral inference networks. Trivial defaults for logging and stats hooks. Executes the training of spectral inference networks. Spectral Inference Networks (SpIN) This package provides an implementation of Spectral Inference Networks, as in Pfau, Petersen, Agarwal, Barrett and Stachenfeld (2018). This is not an officially supported Google product. Prerequisites SpIN requires a working installation of Python and TensorFlow. We recommend running it on GPU for faster convergence. If you want to make use of the GUI (on by default) you will also need Tcl/Tk installed on your system. Installation After cloning the repo, run pip to install the package and its Python dependencies: cd spectral_inference_networks pip install . Usage Training a spectral inference network is similar to most other deep learning pipelines: you must construct a data source, network architecture and optimizer. What makes spectral inference networks unique is that instead of a loss you provide a linear operator to diagonalize. The code expects an object of the LinearOperator class, which can be constructed from a similarity kernel or by other means. LinearOperator objects can be added together or multiplied by a scalar. Below is a minimal example of training spectral inference networks: ```python import tensorflow as tf import spectral_inference_networks as spin batch_size = 1024 input_dim = 10 num_eigenvalues = 5 iterations = 1000 # number of training iterations Create variables for simple MLP w1 = tf.Variable(tf.random.normal([input_dim, 64])) w2 = tf.Variable(tf.random.normal([64, num_eigenvalues])) b1 = tf.Variable(tf.random.normal([64])) b2 = tf.Variable(tf.random.normal([num_eigenvalues])) Create function to construct simple MLP def network(x): h1 = tf.nn.relu(tf.matmul(x, w1) + b1) return tf.matmul(h1, w2) + b2 data = tf.random.normal([batch_size, input_dim]) # replace with actual data Squared exponential kernel. kernel = lambda x, y: tf.exp(-(tf.norm(x-y, axis=1, keepdims=True)**2)) linop = spin.KernelOperator(kernel) optim = tf.train.AdamOptimizer() Constructs the internal training ops for spectral inference networks. spectral_net = spin.SpectralNetwork( linop, network, data, [w1, w2, b1, b2]) Trivial defaults for logging and stats hooks. logging_config = { ‘config’: {}, ‘log_image_every’: iterations, ‘save_params_every’: iterations, ‘saver_path’: ‘/tmp’, ‘saver_name’: ‘example’, } stats_hooks = { ‘create’: spin.util.create_default_stats, ‘update’: spin.util.update_default_stats, } Executes the training of spectral inference networks. stats = spectral_net.train( optim, iterations, logging_config, stats_hooks)","@type":"BlogPosting","url":"https://mlops-github.com/docs/spectral-interface.html","headline":"Spectral Inference","dateModified":"2020-06-16T12:38:47-05:00","datePublished":"2020-06-16T12:38:47-05:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://mlops-github.com/feed.xml" title="Machine Learning Ops" /><script>
if(!(window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1")) {
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57531313-6', 'auto');
  ga('send', 'pageview');
}
</script>
  
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
    integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs=" crossorigin="anonymous"></script>
   <style>
    body {
      background: #1b1f23;
    }
  </style>
</head><body class="doc_page"><header class="site-header" role="banner">
  <div class="navbar">

    <div class="logo">
      <!-- <img src="/assets/images/Data-driven-recommendations.png" alt="logo"> --><svg aria-hidden="true" class="indexesm__StyledOcticon-sc-1ao7p5-27 xrdzL" height="32" role="img" viewBox="0 0 16 16" width="32" style="display:inline-block;fill:currentColor;user-select:none;vertical-align:text-bottom"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg><a href="/">
        <span>Machine Learning Ops</span>
      </a>
    </div>

    <nav class="navigation hidden" id="navigation">
      
      <a href="/blog" >Blog Posts</a>
      
      <a href="/actions" >GitHub Actions</a>
      
      <a href="/examples" >Examples</a>
      
      <a href="/talks" >Talks</a>
      
      <a href="/docs" >Docs</a>
      
      <a href="/team" >Team</a></nav>

    <button class="toggle_mnu" id="toggle_menu" onclick="toggle_menu()">
      <img src="/assets/images/sandwich_white.png" class="open toggle_icon" alt="menu open">
      <img src="/assets/images/times.png" class="close toggle_icon hidden" alt="menu close">
    </button>
  </div>
</header><main class="page-content docs" aria-label="Content"><aside class="sidebar_left">
  <nav>
    <h2>Sections</h2>

    <ul class="aside_nav" id="aside_nav"><li>
        <a class="aside_nav_link" href="/docs/readme.html">Read Me</a></li><li>
        <a class="aside_nav_link" href="/docs/Issue-Label-Bot.html">Issue Label Bot</a></li><li>
        <a class="aside_nav_link" href="/docs/Markdown-here.html">Markdown Here</a></li><li>
        <a class="aside_nav_link" href="/docs/configuration.html">Configuration</a></li><li>
        <a class="aside_nav_link" href="/docs/Markdownsource.html">Sources for markdown</a></li><li>
        <a class="aside_nav_link" href="/docs/ui-components">UI Components</a><span class="toggle_sub rot180"> &#94;</span>

        <ul class="sub_menu hidden"><li>
            <a class="aside_nav_link " href="/docs/ui-components/typography.html">Typography rules</a><span class="toggle_sub rot180"> &#94;</span>

            <ul class="sub_menu hidden"><li style="margin-left: 10px;">
                <a class="aside_nav_link" href="/docs/utilities/typography/font.html">Fonts</a>
              </li><li style="margin-left: 10px;">
                <a class="aside_nav_link" href="/docs/utilities/typography/text.html">Text</a>
              </li></ul></li><li>
            <a class="aside_nav_link " href="/docs/ui-components/buttons.html">Buttons</a></li><li>
            <a class="aside_nav_link " href="/docs/ui-components/labels.html">Labels</a></li><li>
            <a class="aside_nav_link " href="/docs/ui-components/tables.html">Tables</a></li><li>
            <a class="aside_nav_link " href="/docs/ui-components/lists.html">Lists</a></li><li>
            <a class="aside_nav_link " href="/docs/ui-components/code.html">Code</a></li></ul></li><li>
        <a class="aside_nav_link" href="/docs/utilities">Utilities</a><span class="toggle_sub rot180"> &#94;</span>

        <ul class="sub_menu hidden"><li>
            <a class="aside_nav_link " href="/docs/utilities/responsive-modifiers.html">Responsive Modifiers</a></li><li>
            <a class="aside_nav_link " href="/docs/utilities/layout.html">Layout</a></li><li>
            <a class="aside_nav_link " href="/docs/utilities/color.html">Color</a></li><li>
            <a class="aside_nav_link " href="/docs/utilities/typogr.html">Typography</a></li></ul></li><li>
        <a class="aside_nav_link" href="/docs/navigation-structure.html">Navigation Structure</a></li><li class="active">
        <a class="aside_nav_link active"" href="/docs/spectral-interface.html">Spectral Inference</a></li><li>
        <a class="aside_nav_link" href="/docs/customization.html">Customization</a></li><li>
        <a class="aside_nav_link" href="/docs/welcome-to-jekyll.html">Welcome to Jekyll!</a></li><li>
        <a class="aside_nav_link" href="/docs/search.html">Search</a></li><li>
        <a class="aside_nav_link" href="/docs/working-with-run-debug.html">Work with run/debug configurations</a></li><li>
        <a class="aside_nav_link" href="/docs/index-test.html">Markdown kitchen sink</a></li></ul>
  </nav>
</aside><article class="h-entry document" itemscope itemtype="http://schema.org/BlogPosting">
  <div>
    <header class="doc_header">
      <h1 class="doc_title p-name" itemprop="name headline">Spectral Inference</h1>
    </header>

    <div class="doc_content e-content" itemprop="articleBody">
      <ul id="markdown-toc">
  <li><a href="#spectral-inference-networks-spin" id="markdown-toc-spectral-inference-networks-spin">Spectral Inference Networks (SpIN)</a></li>
  <li><a href="#prerequisites" id="markdown-toc-prerequisites">Prerequisites</a></li>
  <li><a href="#installation" id="markdown-toc-installation">Installation</a></li>
  <li><a href="#usage" id="markdown-toc-usage">Usage</a></li>
  <li><a href="#create-variables-for-simple-mlp" id="markdown-toc-create-variables-for-simple-mlp">Create variables for simple MLP</a></li>
  <li><a href="#create-function-to-construct-simple-mlp" id="markdown-toc-create-function-to-construct-simple-mlp">Create function to construct simple MLP</a></li>
  <li><a href="#squared-exponential-kernel" id="markdown-toc-squared-exponential-kernel">Squared exponential kernel.</a></li>
  <li><a href="#constructs-the-internal-training-ops-for-spectral-inference-networks" id="markdown-toc-constructs-the-internal-training-ops-for-spectral-inference-networks">Constructs the internal training ops for spectral inference networks.</a></li>
  <li><a href="#trivial-defaults-for-logging-and-stats-hooks" id="markdown-toc-trivial-defaults-for-logging-and-stats-hooks">Trivial defaults for logging and stats hooks.</a></li>
  <li><a href="#executes-the-training-of-spectral-inference-networks" id="markdown-toc-executes-the-training-of-spectral-inference-networks">Executes the training of spectral inference networks.</a></li>
</ul>

<h2 id="spectral-inference-networks-spin">Spectral Inference Networks (SpIN)</h2>

<p>This package provides an implementation of Spectral Inference Networks,
as in <a href="https://arxiv.org/abs/1806.02215">Pfau, Petersen, Agarwal, Barrett and Stachenfeld (2018)</a>.</p>

<p>This is not an officially supported Google product.</p>

<h2 id="prerequisites">Prerequisites</h2>
<p>SpIN requires a working installation of Python and TensorFlow. We recommend
running it on GPU for faster convergence.</p>

<p>If you want to make use of the GUI (on by default) you will also need Tcl/Tk
installed on your system.</p>

<h2 id="installation">Installation</h2>
<p>After cloning the repo, run pip to install the package and its Python
dependencies:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>spectral_inference_networks
pip <span class="nb">install</span> <span class="nb">.</span>
</code></pre></div></div>

<h2 id="usage">Usage</h2>
<p>Training a spectral inference network is similar to most other deep learning
pipelines: you must construct a data source, network architecture and optimizer.
What makes spectral inference networks unique is that instead of a loss you
provide a linear operator to diagonalize. The code expects an object of the
LinearOperator class, which can be constructed from a similarity kernel or by
other means. LinearOperator objects can be added together or multiplied by a
scalar.</p>

<p>Below is a minimal example of training spectral inference networks:</p>

<p>```python
import tensorflow as tf
import spectral_inference_networks as spin</p>

<p>batch_size = 1024
input_dim = 10
num_eigenvalues = 5
iterations = 1000  # number of training iterations</p>

<h2 id="create-variables-for-simple-mlp">Create variables for simple MLP</h2>
<p>w1 = tf.Variable(tf.random.normal([input_dim, 64]))
w2 = tf.Variable(tf.random.normal([64, num_eigenvalues]))</p>

<p>b1 = tf.Variable(tf.random.normal([64]))
b2 = tf.Variable(tf.random.normal([num_eigenvalues]))</p>

<h2 id="create-function-to-construct-simple-mlp">Create function to construct simple MLP</h2>
<p>def network(x):
  h1 = tf.nn.relu(tf.matmul(x, w1) + b1)
  return tf.matmul(h1, w2) + b2</p>

<p>data = tf.random.normal([batch_size, input_dim])  # replace with actual data</p>
<h2 id="squared-exponential-kernel">Squared exponential kernel.</h2>
<p>kernel = lambda x, y: tf.exp(-(tf.norm(x-y, axis=1, keepdims=True)**2))
linop = spin.KernelOperator(kernel)
optim = tf.train.AdamOptimizer()</p>

<h2 id="constructs-the-internal-training-ops-for-spectral-inference-networks">Constructs the internal training ops for spectral inference networks.</h2>
<p>spectral_net = spin.SpectralNetwork(
    linop,
    network,
    data,
    [w1, w2, b1, b2])</p>

<h2 id="trivial-defaults-for-logging-and-stats-hooks">Trivial defaults for logging and stats hooks.</h2>
<p>logging_config = {
    ‘config’: {},
    ‘log_image_every’: iterations,
    ‘save_params_every’: iterations,
    ‘saver_path’: ‘/tmp’,
    ‘saver_name’: ‘example’,
}</p>

<p>stats_hooks = {
    ‘create’: spin.util.create_default_stats,
    ‘update’: spin.util.update_default_stats,
}</p>

<h2 id="executes-the-training-of-spectral-inference-networks">Executes the training of spectral inference networks.</h2>
<p>stats = spectral_net.train(
    optim,
    iterations,
    logging_config,
    stats_hooks)</p>

    </div>
  </div>
  <a class="u-url" href="/docs/spectral-interface.html" hidden></a>

  <aside class="sidebar_right">
    
    </nav>
  </aside>
</article>
  </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="footer_wrapper">

    <!-- <h2 class="footer-heading">Machine Learning Ops</h2> -->

    <div class="footer_grid">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Machine Learning Ops</li><li><a class="u-email" href="mailto:"></a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/github"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">github</span></a></li><li><a href="https://www.twitter.com/github"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">github</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>A collection of resources on how to facilitate Machine Learning Ops with GitHub.</p>
      </div>
    </div>

  </div>

</footer><script src="/assets/js/common.js"></script>
</body>

</html>